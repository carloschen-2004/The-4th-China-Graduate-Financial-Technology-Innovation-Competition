2025-10-18 09:46:40,414 - INFO - multi_step - Training Step1 model...
2025-10-18 09:48:52,152 - INFO - multi_step - Training Step1 model...
2025-10-18 09:48:52,690 - INFO - multi_step - Step1 Precision@5: 0.029200, NDCG@5: 0.099652
2025-10-18 09:48:52,698 - INFO - multi_step - Training Step2 model (with first_accepted)...
2025-10-18 09:48:53,705 - INFO - multi_step - Metrics: {'step1_precision_atk': 0.0292, 'step1_ndcg_atk': 0.09965173984056987, 'final_precision_atk': 0.01275, 'final_ndcg_atk': 0.02991125707750656, 'step1_user_hitrate_top1': np.float64(0.083), 'combined_user_hitrate': np.float64(0.1125), 'relative_improvement': np.float64(0.355421682464799)}
2025-10-18 17:38:47,545 - INFO - multi_step - === Step 1: Loading data ===
2025-10-18 17:38:49,260 - INFO - multi_step - Building user-product pairs...
2025-10-18 17:39:00,939 - INFO - multi_step - === Step 2: Training Stage 1 model ===
2025-10-18 17:39:11,497 - INFO - multi_step - Stage1 Precision@5: 0.028940, NDCG@5: 0.106286
2025-10-18 17:39:11,542 - INFO - multi_step - === Step 3: Training Stage 2 model (feedback-aware) ===
2025-10-18 17:39:24,758 - INFO - multi_step - Evaluation Metrics: {'stage1_precision@k': 0.028940000000000004, 'stage1_ndcg@k': 0.10628599422396191, 'final_precision@k': 0.00903, 'final_ndcg@k': 0.0212827791068486, 'stage1_hitrate_top1': np.float64(0.1), 'combined_hitrate': np.float64(0.1118), 'relative_improvement': np.float64(0.11799999881999991)}
2025-10-18 17:39:24,758 - INFO - multi_step - === Step 4: Generating SHAP interpretability plots ===
2025-10-18 17:40:56,522 - INFO - multi_step - === Step 1: Loading data ===
2025-10-18 17:40:58,026 - INFO - multi_step - Building user-product pairs...
2025-10-18 17:41:09,187 - INFO - multi_step - === Step 2: Training Stage 1 model ===
2025-10-18 17:41:16,308 - INFO - multi_step - Stage1 Precision@5: 0.028940, NDCG@5: 0.106186
2025-10-18 17:41:16,350 - INFO - multi_step - === Step 3: Training Stage 2 model (feedback-aware) ===
2025-10-18 17:41:26,323 - INFO - multi_step - Evaluation Metrics: {'stage1_precision@k': 0.028939999999999997, 'stage1_ndcg@k': 0.10618642523809144, 'final_precision@k': 0.00909, 'final_ndcg@k': 0.0213473643563353, 'stage1_hitrate_top1': np.float64(0.09975), 'combined_hitrate': np.float64(0.11175), 'relative_improvement': np.float64(0.12030075067367664)}
2025-10-18 17:41:26,323 - INFO - multi_step - === Step 4: Generating SHAP interpretability plots ===
2025-10-18 17:46:24,061 - INFO - multi_step - === Step 1: Loading data ===
2025-10-18 17:46:25,543 - INFO - multi_step - Building user-product pairs...
2025-10-18 17:46:36,652 - INFO - multi_step - === Step 2: Training Stage 1 model ===
2025-10-18 17:46:48,284 - INFO - multi_step - Stage1 Precision@5: 0.028950, NDCG@5: 0.106509
2025-10-18 17:46:48,325 - INFO - multi_step - === Step 3: Training Stage 2 model (feedback-aware) ===
2025-10-18 17:47:02,404 - INFO - multi_step - Evaluation Metrics: {'stage1_precision@k': 0.02895, 'stage1_ndcg@k': 0.10650861265944395, 'final_precision@k': 0.0089, 'final_ndcg@k': 0.02101459457826707, 'stage1_hitrate_top1': np.float64(0.10065), 'combined_hitrate': np.float64(0.1118), 'relative_improvement': np.float64(0.11077992935141642)}
2025-10-18 17:47:02,404 - INFO - multi_step - === Step 4: Generating SHAP interpretability plots ===
2025-10-18 17:48:08,778 - INFO - multi_step - === Step 1: Loading data ===
2025-10-18 17:48:10,242 - INFO - multi_step - Building user-product pairs...
2025-10-18 17:48:21,149 - INFO - multi_step - === Step 2: Training Stage 1 model ===
2025-10-18 17:48:30,351 - INFO - multi_step - Stage1 Precision@5: 0.028970, NDCG@5: 0.106367
2025-10-18 17:48:30,392 - INFO - multi_step - === Step 3: Training Stage 2 model (feedback-aware) ===
2025-10-18 17:48:42,240 - INFO - multi_step - Evaluation Metrics: {'stage1_precision@k': 0.02897, 'stage1_ndcg@k': 0.10636689788297668, 'final_precision@k': 0.009020000000000002, 'final_ndcg@k': 0.02130139814213071, 'stage1_hitrate_top1': np.float64(0.1), 'combined_hitrate': np.float64(0.11185), 'relative_improvement': np.float64(0.118499998815)}
2025-10-18 17:48:42,240 - INFO - multi_step - === Step 4: Generating SHAP interpretability plots ===
2025-10-18 18:03:58,273 - INFO - multi_step - === Step 1: Loading data ===
2025-10-18 18:03:59,923 - INFO - multi_step - Building user-product pairs...
2025-10-18 18:04:11,368 - INFO - multi_step - === Step 2: Training Stage 1 model ===
2025-10-18 18:04:22,977 - INFO - multi_step - Stage1 Precision@5: 0.029000, NDCG@5: 0.106571
2025-10-18 18:04:23,019 - INFO - multi_step - === Step 3: Training Stage 2 model (feedback-aware) ===
2025-10-18 18:04:36,781 - INFO - multi_step - Evaluation Metrics: {'stage1_precision@k': 0.029, 'stage1_ndcg@k': 0.10657111388330959, 'final_precision@k': 0.0089, 'final_ndcg@k': 0.020975075675932892, 'stage1_hitrate_top1': np.float64(0.10075), 'combined_hitrate': np.float64(0.11175), 'relative_improvement': np.float64(0.10918114035552214)}
2025-10-18 18:04:36,781 - INFO - multi_step - === Step 4: Generating SHAP interpretability plots ===
2025-10-18 18:08:29,368 - INFO - multi_step - === Step 1: Loading data ===
2025-10-18 18:08:30,832 - INFO - multi_step - Building user-product pairs...
2025-10-18 18:08:41,738 - INFO - multi_step - === Step 2: Training Stage 1 model ===
2025-10-18 18:08:50,271 - INFO - multi_step - Stage1 Precision@5: 0.028970, NDCG@5: 0.106229
2025-10-18 18:08:50,316 - INFO - multi_step - === Step 3: Training Stage 2 model (feedback-aware) ===
2025-10-18 18:09:01,210 - INFO - multi_step - Evaluation Metrics: {'stage1_precision@k': 0.028970000000000006, 'stage1_ndcg@k': 0.10622876621375538, 'final_precision@k': 0.009130000000000001, 'final_ndcg@k': 0.021395281628873476, 'stage1_hitrate_top1': np.float64(0.09965), 'combined_hitrate': np.float64(0.1119), 'relative_improvement': np.float64(0.12293025466201447)}
2025-10-18 18:09:01,210 - INFO - multi_step - === Step 4: Generating SHAP interpretability plots ===
2025-10-18 21:34:56,034 - INFO - multi_step - === Step 1: Loading data ===
2025-10-18 21:34:58,208 - INFO - multi_step - Building user-product pairs...
2025-10-18 21:35:14,027 - INFO - multi_step - === Step 2: Training Stage 1 model ===
2025-10-18 21:35:25,465 - INFO - multi_step - Stage1 Precision@5: 0.028950, NDCG@5: 0.106195
2025-10-18 21:35:25,523 - INFO - multi_step - === Step 3: Training Stage 2 model (feedback-aware) ===
2025-10-18 21:35:56,668 - INFO - multi_step - Evaluation Metrics: {'stage1_precision@k': 0.02895, 'stage1_ndcg@k': 0.10619536501674995, 'final_precision@k': 0.0091, 'final_ndcg@k': 0.02129524354228573, 'stage1_hitrate_top1': np.float64(0.0997), 'combined_hitrate': np.float64(0.1119), 'relative_improvement': np.float64(0.12236710007655871)}
2025-10-18 21:36:45,551 - INFO - multi_step - === Step 1: Loading data ===
2025-10-18 21:36:47,592 - INFO - multi_step - Building user-product pairs...
2025-10-18 21:37:02,090 - INFO - multi_step - === Step 2: Training Stage 1 model ===
2025-10-18 21:37:20,478 - INFO - multi_step - Stage1 Precision@5: 0.029010, NDCG@5: 0.106471
2025-10-18 21:37:20,538 - INFO - multi_step - === Step 3: Training Stage 2 model (feedback-aware) ===
2025-10-18 21:37:42,402 - INFO - multi_step - Evaluation Metrics: {'stage1_precision@k': 0.02901, 'stage1_ndcg@k': 0.10647069913090489, 'final_precision@k': 0.00898, 'final_ndcg@k': 0.021138910625942003, 'stage1_hitrate_top1': np.float64(0.10045), 'combined_hitrate': np.float64(0.11175), 'relative_improvement': np.float64(0.1124937768791063)}
2025-10-18 21:37:42,402 - INFO - multi_step - === Step 4: Generating SHAP interpretability plots ===
2025-10-18 21:51:00,538 - INFO - multi_step - === Step 1: Loading data ===
2025-10-18 21:51:02,376 - INFO - multi_step - Building user-product pairs...
2025-10-18 21:51:15,836 - INFO - multi_step - === Step 2: Training Stage 1 model ===
2025-10-18 21:51:26,685 - INFO - multi_step - Stage1 Precision@5: 0.028940, NDCG@5: 0.106263
2025-10-18 21:51:26,741 - INFO - multi_step - === Step 3: Training Stage 2 model (feedback-aware) ===
2025-10-18 21:51:41,111 - INFO - multi_step - Evaluation Metrics: {'stage1_precision@k': 0.028939999999999997, 'stage1_ndcg@k': 0.1062626679631843, 'final_precision@k': 0.00903, 'final_ndcg@k': 0.021270933530471887, 'stage1_hitrate_top1': np.float64(0.0999), 'combined_hitrate': np.float64(0.1118), 'relative_improvement': np.float64(0.11911911792673549)}
2025-10-18 21:51:41,112 - INFO - multi_step - === Step 4: Generating SHAP interpretability plots ===
2025-10-18 21:52:18,360 - INFO - multi_step - === Step 1: Loading data ===
2025-10-18 21:52:20,268 - INFO - multi_step - Building user-product pairs...
2025-10-18 21:52:33,962 - INFO - multi_step - === Step 2: Training Stage 1 model ===
2025-10-18 21:52:55,345 - INFO - multi_step - Stage1 Precision@5: 0.028920, NDCG@5: 0.106224
2025-10-18 21:52:55,400 - INFO - multi_step - === Step 3: Training Stage 2 model (feedback-aware) ===
2025-10-18 21:53:13,910 - INFO - multi_step - Evaluation Metrics: {'stage1_precision@k': 0.028920000000000005, 'stage1_ndcg@k': 0.10622426278179202, 'final_precision@k': 0.009009999999999999, 'final_ndcg@k': 0.02121018597539255, 'stage1_hitrate_top1': np.float64(0.10005), 'combined_hitrate': np.float64(0.1118), 'relative_improvement': np.float64(0.11744127818649394)}
2025-10-18 21:53:13,910 - INFO - multi_step - === Step 4: Generating SHAP interpretability plots ===
2025-10-18 21:58:05,414 - INFO - multi_step - === Step 1: Loading data ===
2025-10-18 21:58:07,361 - INFO - multi_step - Building user-product pairs...
2025-10-18 21:58:21,764 - INFO - multi_step - === Step 2: Training Stage 1 model ===
2025-10-18 21:58:32,447 - INFO - multi_step - Stage1 Precision@5: 0.028920, NDCG@5: 0.106366
2025-10-18 21:58:32,504 - INFO - multi_step - === Step 3: Training Stage 2 model (feedback-aware) ===
2025-10-18 21:58:47,385 - INFO - multi_step - Evaluation Metrics: {'stage1_precision@k': 0.028920000000000005, 'stage1_ndcg@k': 0.10636560658255553, 'final_precision@k': 0.00895, 'final_ndcg@k': 0.020999009278141342, 'stage1_hitrate_top1': np.float64(0.1001), 'combined_hitrate': np.float64(0.1118), 'relative_improvement': np.float64(0.11688311571545341)}
2025-10-18 21:58:47,385 - INFO - multi_step - === Step 4: Generating SHAP interpretability plots ===
2025-10-18 22:00:12,690 - INFO - multi_step - === Step 1: Loading data ===
2025-10-18 22:00:14,535 - INFO - multi_step - Building user-product pairs...
2025-10-18 22:00:46,067 - INFO - multi_step - === Step 2: Training Stage 1 model ===
2025-10-18 22:01:04,106 - INFO - multi_step - Stage1 Precision@5: 0.028970, NDCG@5: 0.106481
2025-10-18 22:01:04,160 - INFO - multi_step - === Step 3: Training Stage 2 model (feedback-aware) ===
2025-10-18 22:01:29,633 - INFO - multi_step - Evaluation Metrics: {'stage1_precision@k': 0.028970000000000006, 'stage1_ndcg@k': 0.10648113936526793, 'final_precision@k': 0.00894, 'final_ndcg@k': 0.021154542539382763, 'stage1_hitrate_top1': np.float64(0.10055), 'combined_hitrate': np.float64(0.1117), 'relative_improvement': np.float64(0.11089010332282337)}
2025-10-18 22:01:29,633 - INFO - multi_step - === Step 4: Generating SHAP interpretability plots ===
2025-10-18 22:01:55,351 - INFO - multi_step - === Step 1: Loading data ===
2025-10-18 22:01:57,387 - INFO - multi_step - Building user-product pairs...
2025-10-18 22:03:02,509 - INFO - multi_step - === Step 2: Training Stage 1 model ===
2025-10-18 22:03:13,373 - INFO - multi_step - Stage1 Precision@5: 0.029020, NDCG@5: 0.106658
2025-10-18 22:03:13,428 - INFO - multi_step - === Step 3: Training Stage 2 model (feedback-aware) ===
2025-10-18 22:03:30,525 - INFO - multi_step - Evaluation Metrics: {'stage1_precision@k': 0.029019999999999997, 'stage1_ndcg@k': 0.10665828855748433, 'final_precision@k': 0.00893, 'final_ndcg@k': 0.0208623196256514, 'stage1_hitrate_top1': np.float64(0.1007), 'combined_hitrate': np.float64(0.11185), 'relative_improvement': np.float64(0.11072492442179824)}
2025-10-18 22:03:30,525 - INFO - multi_step - === Step 4: Generating SHAP interpretability plots ===
2025-10-18 22:04:01,632 - INFO - multi_step - === Step 1: Loading data ===
2025-10-18 22:04:03,460 - INFO - multi_step - Building user-product pairs...
2025-10-18 22:04:16,881 - INFO - multi_step - === Step 2: Training Stage 1 model ===
2025-10-18 22:04:31,625 - INFO - multi_step - Stage1 Precision@5: 0.028970, NDCG@5: 0.106376
2025-10-18 22:04:31,679 - INFO - multi_step - === Step 3: Training Stage 2 model (feedback-aware) ===
2025-10-18 22:04:59,483 - INFO - multi_step - Evaluation Metrics: {'stage1_precision@k': 0.02897, 'stage1_ndcg@k': 0.10637649456025347, 'final_precision@k': 0.00895, 'final_ndcg@k': 0.021189523015658483, 'stage1_hitrate_top1': np.float64(0.1003), 'combined_hitrate': np.float64(0.11175), 'relative_improvement': np.float64(0.114157526279586)}
2025-10-18 22:04:59,484 - INFO - multi_step - === Step 4: Generating SHAP interpretability plots ===
2025-10-18 22:05:31,799 - INFO - multi_step - === Step 1: Loading data ===
2025-10-18 22:05:33,640 - INFO - multi_step - Building user-product pairs...
2025-10-18 22:05:47,307 - INFO - multi_step - === Step 2: Training Stage 1 model ===
2025-10-18 22:06:24,213 - INFO - multi_step - Stage1 Precision@5: 0.028970, NDCG@5: 0.106208
2025-10-18 22:06:24,454 - INFO - multi_step - === Step 3: Training Stage 2 model (feedback-aware) ===
2025-10-18 22:06:51,644 - INFO - multi_step - Evaluation Metrics: {'stage1_precision@k': 0.028970000000000006, 'stage1_ndcg@k': 0.10620786344587188, 'final_precision@k': 0.0091, 'final_ndcg@k': 0.021456068246231138, 'stage1_hitrate_top1': np.float64(0.09965), 'combined_hitrate': np.float64(0.1119), 'relative_improvement': np.float64(0.12293025466201447)}
2025-10-18 22:06:51,645 - INFO - multi_step - === Step 4: Generating SHAP interpretability plots ===
2025-10-18 22:09:09,913 - INFO - multi_step - === Step 1: Loading data ===
2025-10-18 22:09:14,143 - INFO - multi_step - Building user-product pairs...
2025-10-18 22:09:54,698 - INFO - multi_step - === Step 2: Training Stage 1 model ===
2025-10-18 22:10:14,102 - INFO - multi_step - Stage1 Precision@5: 0.028970, NDCG@5: 0.106350
2025-10-18 22:10:14,174 - INFO - multi_step - === Step 3: Training Stage 2 model (feedback-aware) ===
2025-10-18 22:10:49,589 - INFO - multi_step - Evaluation Metrics: {'stage1_precision@k': 0.028970000000000006, 'stage1_ndcg@k': 0.10634953857988771, 'final_precision@k': 0.009, 'final_ndcg@k': 0.021147608541495343, 'stage1_hitrate_top1': np.float64(0.1002), 'combined_hitrate': np.float64(0.1118), 'relative_improvement': np.float64(0.11576846191847842)}
2025-10-18 22:10:49,590 - INFO - multi_step - === Step 4: Generating SHAP interpretability plots ===
2025-10-18 22:18:30,491 - INFO - multi_step - === Step 1: Loading data ===
2025-10-18 22:18:34,208 - INFO - multi_step - Building user-product pairs...
2025-10-18 22:19:04,856 - INFO - multi_step - === Step 2: Training Stage 1 model ===
2025-10-18 22:19:25,558 - INFO - multi_step - Stage1 Precision@5: 0.028990, NDCG@5: 0.106458
2025-10-18 22:19:25,664 - INFO - multi_step - === Step 3: Training Stage 2 model (feedback-aware) ===
2025-10-18 22:19:55,891 - INFO - multi_step - Evaluation Metrics: {'stage1_precision@k': 0.02899, 'stage1_ndcg@k': 0.10645781005598305, 'final_precision@k': 0.00899, 'final_ndcg@k': 0.021205963574123687, 'stage1_hitrate_top1': np.float64(0.1003), 'combined_hitrate': np.float64(0.1119), 'relative_improvement': np.float64(0.1156530397242967)}
2025-10-18 22:19:55,892 - INFO - multi_step - === Step 4: Generating SHAP interpretability plots ===
2025-10-18 22:21:46,965 - INFO - multi_step - === Step 1: Loading data ===
2025-10-18 22:21:50,273 - INFO - multi_step - Building user-product pairs...
2025-10-18 22:22:16,251 - INFO - multi_step - === Step 2: Training Stage 1 model ===
2025-10-18 22:22:48,571 - INFO - multi_step - Stage1 Precision@5: 0.028980, NDCG@5: 0.106560
2025-10-18 22:22:48,664 - INFO - multi_step - === Step 3: Training Stage 2 model (feedback-aware) ===
2025-10-18 22:23:29,829 - INFO - multi_step - Evaluation Metrics: {'stage1_precision@k': 0.028980000000000002, 'stage1_ndcg@k': 0.10656012629083066, 'final_precision@k': 0.00891, 'final_ndcg@k': 0.021037071578913435, 'stage1_hitrate_top1': np.float64(0.1006), 'combined_hitrate': np.float64(0.11175), 'relative_improvement': np.float64(0.11083498895790277)}
2025-10-18 22:23:29,830 - INFO - multi_step - === Step 4: Generating SHAP interpretability plots ===
2025-10-18 22:26:33,600 - INFO - multi_step - === Step 1: Loading data ===
2025-10-18 22:26:39,212 - INFO - multi_step - Building user-product pairs...
2025-10-18 22:27:43,441 - INFO - multi_step - === Step 2: Training Stage 1 model ===
2025-10-18 22:28:16,944 - INFO - multi_step - Stage1 Precision@5: 0.028950, NDCG@5: 0.106193
2025-10-18 22:28:17,157 - INFO - multi_step - === Step 3: Training Stage 2 model (feedback-aware) ===
2025-10-18 22:29:11,704 - INFO - multi_step - Evaluation Metrics: {'stage1_precision@k': 0.02895, 'stage1_ndcg@k': 0.10619331679433126, 'final_precision@k': 0.00909, 'final_ndcg@k': 0.021346207693992328, 'stage1_hitrate_top1': np.float64(0.09975), 'combined_hitrate': np.float64(0.11185), 'relative_improvement': np.float64(0.12130325692929064)}
2025-10-18 22:29:11,705 - INFO - multi_step - === Step 4: Generating SHAP interpretability plots ===
2025-10-18 22:30:44,559 - INFO - multi_step - === Step 1: Loading data ===
2025-10-18 22:30:47,982 - INFO - multi_step - Building user-product pairs...
2025-10-18 22:31:13,329 - INFO - multi_step - === Step 2: Training Stage 1 model ===
2025-10-18 22:31:32,121 - INFO - multi_step - Stage1 Precision@5: 0.028920, NDCG@5: 0.106372
2025-10-18 22:31:32,220 - INFO - multi_step - === Step 3: Training Stage 2 model (feedback-aware) ===
2025-10-18 22:31:59,459 - INFO - multi_step - Evaluation Metrics: {'stage1_precision@k': 0.028919999999999998, 'stage1_ndcg@k': 0.10637158059383382, 'final_precision@k': 0.00892, 'final_ndcg@k': 0.02082472532731186, 'stage1_hitrate_top1': np.float64(0.10035), 'combined_hitrate': np.float64(0.11175), 'relative_improvement': np.float64(0.11360239049723585)}
2025-10-18 22:31:59,460 - INFO - multi_step - === Step 4: Generating SHAP interpretability plots ===
2025-10-18 23:51:33,057 - INFO - multi_step - === Step 1: Loading data ===
2025-10-18 23:51:34,614 - INFO - multi_step - Building user-product pairs...
2025-10-18 23:51:46,095 - INFO - multi_step - === Step 2: Training Stage 1 model ===
2025-10-18 23:51:54,580 - INFO - multi_step - Stage1 Precision@5: 0.029000, NDCG@5: 0.106342
2025-10-18 23:51:54,620 - INFO - multi_step - === Step 3: Training Stage 2 model (feedback-aware) ===
2025-10-18 23:52:09,864 - INFO - multi_step - Evaluation Metrics: {'stage1_precision@k': 0.029, 'stage1_ndcg@k': 0.10634226659258461, 'final_precision@k': 0.0091, 'final_ndcg@k': 0.021438578505544082, 'stage1_hitrate_top1': np.float64(0.0999), 'combined_hitrate': np.float64(0.1118), 'relative_improvement': np.float64(0.11911911792673549)}
2025-10-18 23:52:09,865 - INFO - multi_step - === Step 4: Generating SHAP interpretability plots ===
2025-10-18 23:53:19,693 - INFO - multi_step - === Step 1: Loading data ===
2025-10-18 23:53:21,094 - INFO - multi_step - Building user-product pairs...
2025-10-18 23:53:31,562 - INFO - multi_step - === Step 2: Training Stage 1 model ===
2025-10-18 23:53:40,400 - INFO - multi_step - Stage1 Precision@5: 0.028970, NDCG@5: 0.106646
2025-10-18 23:53:40,440 - INFO - multi_step - === Step 3: Training Stage 2 model (feedback-aware) ===
2025-10-18 23:53:52,037 - INFO - multi_step - Evaluation Metrics: {'stage1_precision@k': 0.028970000000000006, 'stage1_ndcg@k': 0.10664567778417432, 'final_precision@k': 0.008790000000000001, 'final_ndcg@k': 0.02064822000529362, 'stage1_hitrate_top1': np.float64(0.1011), 'combined_hitrate': np.float64(0.1118), 'relative_improvement': np.float64(0.10583580508569927)}
2025-10-18 23:53:52,038 - INFO - multi_step - === Step 4: Generating SHAP interpretability plots ===
2025-10-18 23:55:48,027 - INFO - multi_step - === Step 1: Loading data ===
2025-10-18 23:55:49,747 - INFO - multi_step - Building user-product pairs...
2025-10-18 23:56:45,348 - INFO - multi_step - === Step 2: Training Stage 1 model ===
2025-10-18 23:57:15,083 - INFO - multi_step - Stage1 Precision@5: 0.028940, NDCG@5: 0.106326
2025-10-18 23:57:15,131 - INFO - multi_step - === Step 3: Training Stage 2 model (feedback-aware) ===
2025-10-18 23:57:27,089 - INFO - multi_step - Evaluation Metrics: {'stage1_precision@k': 0.028939999999999997, 'stage1_ndcg@k': 0.10632599588521675, 'final_precision@k': 0.008980000000000002, 'final_ndcg@k': 0.02111231344795207, 'stage1_hitrate_top1': np.float64(0.1002), 'combined_hitrate': np.float64(0.11175), 'relative_improvement': np.float64(0.11526945992745055)}
2025-10-18 23:57:27,090 - INFO - multi_step - === Step 4: Generating SHAP interpretability plots ===
2025-10-19 00:05:47,978 - INFO - multi_step - Loading datasets...
2025-10-19 00:05:55,270 - INFO - multi_step - Training Stage 1 model...
2025-10-19 00:06:58,472 - INFO - multi_step - Loading datasets...
2025-10-19 00:07:05,375 - INFO - multi_step - Training Stage 1 model...
2025-10-19 00:07:33,710 - INFO - multi_step - === Step 1: Loading data ===
2025-10-19 00:07:35,006 - INFO - multi_step - Building user-product pairs...
2025-10-19 00:07:40,976 - INFO - multi_step - === Step 2: Training Stage 1 model ===
2025-10-19 00:11:02,920 - INFO - multi_step - Loading datasets...
2025-10-19 00:11:07,170 - INFO - multi_step - Training Stage 1 model...
2025-10-19 00:11:08,063 - INFO - multi_step - Stage1 Precision@5: 0.029050, NDCG@5: 0.103278
2025-10-19 00:11:08,063 - INFO - multi_step - Generating OOF-based first_accepted labels for training Stage2...
2025-10-19 00:11:10,907 - INFO - multi_step - Training Stage 2 model (feedback-aware)...
2025-10-19 00:11:13,572 - INFO - multi_step - Metrics: {'stage1_precision_atk': 0.029049999999999996, 'stage1_ndcg_atk': 0.10327822199555774, 'final_precision_atk': 0.011, 'final_ndcg_atk': 0.02951383786920246, 'stage1_user_hitrate_top1': np.float64(0.0915), 'combined_user_hitrate': np.float64(0.113), 'relative_improvement': np.float64(0.2349726750276211)}
2025-10-19 00:11:13,573 - INFO - multi_step - Generating explainability outputs (SHAP/PDP/importance) for Stage2 model...
2025-10-20 18:39:23,783 - INFO - multi_step - Loading datasets...
2025-10-20 18:39:34,392 - INFO - multi_step - Training Stage 1 model...
2025-10-20 18:39:35,182 - INFO - multi_step - Stage1 Precision@5: 0.029200, NDCG@5: 0.099746
2025-10-20 18:39:35,182 - INFO - multi_step - Generating OOF-based first_accepted labels for training Stage2...
2025-10-20 18:39:36,876 - INFO - multi_step - Training Stage 2 model (feedback-aware)...
2025-10-20 18:39:38,193 - INFO - multi_step - Metrics: {'stage1_precision_atk': 0.0292, 'stage1_ndcg_atk': 0.09974578014388155, 'final_precision_atk': 0.0127, 'final_ndcg_atk': 0.02996326574159149, 'stage1_user_hitrate_top1': np.float64(0.08325), 'combined_user_hitrate': np.float64(0.1125), 'relative_improvement': np.float64(0.3513513471309147)}
2025-10-20 18:41:56,665 - INFO - multi_step - Loading datasets...
2025-10-20 18:49:02,962 - INFO - multi_step - Loading data...
2025-10-20 18:49:04,336 - INFO - multi_step - Building user-product pairs...
2025-10-20 18:49:05,593 - INFO - multi_step - Merging features...
2025-10-20 18:49:05,933 - INFO - multi_step - Feature engineering...
2025-10-20 18:49:08,363 - INFO - multi_step - Training Stage1 model...
2025-10-20 18:49:12,597 - INFO - multi_step - Stage1 Precision@5: 0.029250, NDCG@5: 0.099682
2025-10-20 18:49:12,598 - INFO - multi_step - Generating OOF first_accepted for training Stage2...
2025-10-20 18:49:20,239 - INFO - multi_step - Training Stage2 model (feedback-aware)...
2025-10-20 18:50:01,978 - INFO - multi_step - Loading data...
2025-10-20 18:50:03,286 - INFO - multi_step - Building user-product pairs...
2025-10-20 18:50:04,850 - INFO - multi_step - Merging features...
2025-10-20 18:50:05,273 - INFO - multi_step - Feature engineering...
2025-10-20 18:50:07,936 - INFO - multi_step - Training Stage1 model...
2025-10-20 18:50:15,471 - INFO - multi_step - Stage1 Precision@5: 0.029150, NDCG@5: 0.103472
2025-10-20 18:50:15,472 - INFO - multi_step - Generating OOF first_accepted for training Stage2...
2025-10-20 18:50:33,188 - INFO - multi_step - Training Stage2 model (feedback-aware)...
2025-10-20 18:52:23,637 - INFO - multi_step - Saved detailed recommendations to D:\jinke\fintech_project\output\final_recommendations.csv
2025-10-20 18:52:23,675 - INFO - multi_step - Saved merged recommendations to D:\jinke\fintech_project\output\final_recommendations_merged.csv
2025-10-20 18:52:23,714 - INFO - multi_step - Metrics: {'stage1_precision_atk': 0.02915, 'stage1_ndcg_atk': 0.10347168841602496, 'final_precision_atk': 0.01095, 'final_ndcg_atk': 0.025448013222981705, 'stage1_user_hitrate_top1': np.float64(0.0915), 'combined_user_hitrate': np.float64(0.113), 'relative_improvement': np.float64(0.2349726750276211)}
2025-10-20 18:52:23,715 - INFO - multi_step - Generating explainability outputs for Stage2...
2025-10-21 21:04:43,308 - INFO - multi_step - Loading data...
2025-10-21 21:04:43,565 - INFO - multi_step - Building user-product pairs...
2025-10-21 21:04:46,342 - INFO - multi_step - Merging features...
2025-10-21 21:04:48,964 - INFO - multi_step - Feature engineering...
2025-10-21 21:04:53,948 - INFO - multi_step - Training Stage1 model...
2025-10-21 21:04:54,776 - INFO - multi_step - Stage1 Precision@5: 0.356750, NDCG@5: 0.842750
2025-10-21 21:04:54,777 - INFO - multi_step - Generating OOF first_accepted for training Stage2...
2025-10-21 21:04:59,583 - INFO - multi_step - Training Stage2 model (feedback-aware)...
2025-10-21 21:14:17,892 - INFO - multi_step - Saved detailed recommendations to /Users/keep-rational/Desktop/研创赛-金科-多步推荐/LGBM/fintech_project/output/final_recommendations.csv
2025-10-21 21:14:17,944 - INFO - multi_step - Saved merged recommendations to /Users/keep-rational/Desktop/研创赛-金科-多步推荐/LGBM/fintech_project/output/final_recommendations_merged.csv
2025-10-21 21:14:17,996 - INFO - multi_step - Metrics: {'stage1_precision_atk': 0.35675000000000007, 'stage1_ndcg_atk': 0.84275, 'final_precision_atk': 0.18975, 'final_ndcg_atk': 0.38358825513389455, 'stage1_user_hitrate_top1': np.float64(0.84275), 'combined_user_hitrate': np.float64(0.84275), 'relative_improvement': np.float64(0.0)}
